var GFGeo_Forms={},GF_Geo=function(e,o){this.form_id=e.id,this.page_number=o,this.args=e.gfgeo_args,this.geocoder_id=!1,this.init_load_processing=!1,this.processing={status:!1,element:!1,location:!1,advanced_address:!1,selected_address:"",autocomplete_place:"",found_message:"",hide_error_message:!1,locator_id:"",element_id:""},this.page_locator={triggered:!1},this.map_field_exists=!1,this.autocomplete_triggered=!1,this.ip_locator=gfgeo_options.ip_locator,this.fields=e.geolocation_fields,this.directions_fields=e.directions_fields,this.geocoder_directions_fields=e.geocoder_directions_fields,this.maps={},this.autocompletes={},this.directionsServices={},this.init_geocoding_delay=this.args.init_geocoding_delay};GF_Geo.prototype.init=function(){var e=this;jQuery("form#gform_"+e.form_id).attr("data-form_id",e.form_id),"undefined"!=typeof gform&&(e=gform.applyFilters("gfgeo_form_object",e)),"maxmind"==e.ip_locator&&"undefined"==typeof geoip2&&(e.ip_locator=!1);var o,d,t={geocoders:[],addresses:[],pageLocator:!1,directions:[]};jQuery("#entry_form").find(".ginput_container.ginput_container_gfgeo_directions_panel, .ginput_container.ginput_container_gfgeo_directions.trigger-dynamically, .ginput_container.ginput_container_gfgeo_geocoder").closest("tr").hide(),jQuery.each(e.fields,function(i,s){if(o=s.gfgeo_id,d="undefined"!=typeof s.gfgeo_geocoder_id?s.gfgeo_geocoder_id:"","gfgeo_geocoder"==s.type){var r=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+o);1!=r.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update)&&(jQuery("#gfgeo-geocoder-default-coordinates-"+o).length?1!=r.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update&&1==e.args.geocode_default_location)&&(e.geocoder_id=o,t.geocoders.push(e.geocoder_id)):1==e.args.is_page_load&&1==s.gfgeo_page_locator&&(t.pageLocator=s))}if("gfgeo_map"==s.type&&jQuery("#gfgeo-map-"+o).length&&1!=s.adminOnly&&(e.map_field_exists=!0,"undefined"!=typeof s.gfgeo_delay_map_render?setTimeout(function(){e.render_map(s)},s.gfgeo_delay_map_render):e.render_map(s)),"gfgeo_address"==s.type){var a=jQuery('input.gfgeo-address-field[data-field_id="'+o+'"]');""!=d&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).length&&(e.address_field_init(a,s),1==e.args.is_page_load&&0!=jQuery.trim(a.val()).length&&1!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).find(".status").val()&&t.addresses.push(a)),1==s.gfgeo_address_autocomplete&&"undefined"!=typeof a.attr("id")&&e.address_autocomplete(a.attr("id"),s,!1)}"gfgeo_coordinates"==s.type&&""!=d&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).length&&e.coordinates_field_init(jQuery("#gfgeo-coordinates-wrapper-"+o)),"address"!=s.type||"undefined"!=typeof s.gfgeo_disable_field_geocoding&&1==s.gfgeo_disable_field_geocoding||""!=d&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).length&&e.advanced_address_field_init(jQuery("#field_"+o),s),("text"==s.type||"post_custom_field"==s.type)&&1==s.gfgeo_address_autocomplete&&e.address_autocomplete("input_"+o,s,!1),e.args.is_edit_entry&&"undefined"!=typeof s.gfgeo_dynamic_field_usage&&jQuery(".detail-view#field_"+o).addClass(s.cssClass),("gfgeo_locator_button"===s.type||"gfgeo_address"===s.type||"address"===s.type)&&jQuery(document).on("click","#gfgeo-locator-button-"+o+", #gfgeo-infield-locator-button-"+o,function(){e.processing.status||"undefined"==typeof s.gfgeo_geocoder_id||""==s.gfgeo_geocoder_id.length||(e.geocoder_id=s.gfgeo_geocoder_id,e.processing.locator_id=s.gfgeo_id,e.processing.found_message="undefined"!=typeof s.gfgeo_location_found_message?s.gfgeo_location_found_message:"",e.processing.hide_error_message="undefined"!=typeof s.gfgeo_hide_location_failed_message?s.gfgeo_hide_location_failed_message:!1,0!=e.ip_locator&&(e.processing.ip_locator="undefined"!=typeof s.gfgeo_ip_locator_status?s.gfgeo_ip_locator_status:""),0!=e.ip_locator&&"default"==e.processing.ip_locator?(console.log("IP Address Locator"),e.ip_navigator("ip_locator_button","locator_button_success",!1)):(console.log("HTML5 Locator"),e.navigator("locator_button","locator_button_success",!1)))}),"gfgeo_reset_location_button"===s.type&&jQuery(document).on("click","#gfgeo-reset-location-button-"+o,function(){if(!e.processing.status&&"undefined"!=typeof s.gfgeo_geocoder_id&&s.gfgeo_geocoder_id.length>0){var o=s.gfgeo_geocoder_id;1==o.length?e.clear_fields(o[0],"reset_location_button",!1):jQuery.each(o,function(o,d){setTimeout(function(){e.geocoder_id=d,e.clear_fields(d,"reset_location_button",!1)},300)})}}),"gfgeo_directions"===s.type&&(jQuery("#gfgeo-get-directions-button-"+o).on("click",function(){e.isEmpty(jQuery("#input_"+s.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+s.id).val())&&e.get_directions(jQuery(this).data("field_id"),!1)}),jQuery("#gfgeo-clear-directions-button-"+o).on("click",function(){var o=jQuery(this).data("field_id"),d=e.directions_fields[o];return""==d.gfgeo_origin_geocoder_id?!1:(geocoderId=d.gfgeo_origin_geocoder_id,void e.clear_directions(d,geocoderId))}),e.isEmpty(jQuery("#input_"+s.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+s.id).val())?"button"!=s.gfgeo_trigger_directions_method&&t.directions.push([o,!1]):t.directions.push([o,!0]))});var i=500,s=this.args.init_geocoding_delay,r=t.geocoders.length,a=t.addresses.length,n=t.directions.length;(r>0||a>0||0!=t.pageLocator||n>0)&&(r+a+n>1&&(e.init_load_processing=!0),jQuery.each(t,function(o,d){if("geocoders"==o&&r>0)jQuery.each(d,function(o,d){setTimeout(function(){e.geocoder_id=d,e["debugger"]("Geocoding default geocoder "+d);var o=jQuery("#gfgeo-geocoder-default-coordinates-"+e.geocoder_id).data();e.geocoder("default_coords_geocoder",[o.latitude,o.longitude],"default_coords_geocoder_success",!1)},i),i+=s});else if("addresses"==o&&a>0)jQuery.each(d,function(o,d){setTimeout(function(){e["debugger"]("Geocoding default address "+d.data("field_id")),d.trigger("focusout",[!0])},i),i+=s});else if("pageLocator"==o&&0!=d){var g=d;setTimeout(function(){e["debugger"]("Running page locator."),e.page_locator.triggered=!0,e.processing.found_message=g.gfgeo_location_found_message,e.processing.hide_error_message="undefined"!=typeof g.gfgeo_hide_location_failed_message?g.gfgeo_hide_location_failed_message:!1,e.geocoder_id=g.gfgeo_id,0!=e.ip_locator&&(e.processing.ip_locator=void 0!==g.gfgeo_ip_locator_status?g.gfgeo_ip_locator_status:""),pageLocatorExists=!0,0!=e.ip_locator&&"default"==e.processing.ip_locator?e.ip_navigator("ip_page_locator","page_locator_success",!1):e.navigator("page_locator","page_locator_success",!1)},i)}else if("directions"==o&&n>0){var _=r+a;jQuery.each(d,function(o,d){(1==d[1]||_>1||_>0&&0!=t.pageLocator)&&(setTimeout(function(){e["debugger"]("Default Directions "+d[0]),e.get_directions(d[0],!0)},i),i+=s)})}setTimeout(function(){e.init_load_processing=!1},200+r*s+a*s)})),jQuery(".tingle-modal.gpnf-modal").length&&setTimeout(function(){jQuery(".pac-container").detach().insertBefore("body")},800),e.map_field_exists&&e.resize_map_on_show()},GF_Geo.prototype["debugger"]=function(e){1==this.args.debugger_enabled&&console.log(e)},GF_Geo.prototype.isEmpty=function(e){return"undefined"!=typeof e&&""!=e?!1:!0},GF_Geo.prototype.inArray=function(e,o){for(var d=0;d<o.length;d++)if(o[d]==e)return d;return-1},GF_Geo.prototype.processing_start=function(e,o){var d=this;jQuery("#gform_wrapper_"+d.form_id).addClass("gfgeo-block-layer"),d.processing.status=!0,d.processing.element=e,d.processing.location=o,d.processing.hide_error_message=!1,jQuery.each(d.maps,function(e,o){d.maps[e].map.setOptions({draggable:!1}),jQuery.each(d.maps[e].markers,function(e,o){o.setDraggable(!1)})}),d["debugger"]("Processing start:"),d["debugger"](d.processing),jQuery("body").find('input[type="submit"], .gfgeo-locator-button, input.gfgeo-address-field, input.gfgeo-coordinates-field, .gfgeo-advanced-address input').prop("disabled",!0)},GF_Geo.prototype.processing_end=function(){var e=this;setTimeout(function(){e.processing={status:!1,element:!1,location:!1,advanced_address:!1,hide_error_message:!1,selected_address:"",autocomplete_place:"",found_message:"",locator_id:"",element_id:""},jQuery.each(e.maps,function(o,d){e.maps[o].map.setOptions({draggable:!0}),jQuery.each(e.maps[o].markers,function(e,o){1==jQuery(this)[0].gfgeoArgs.draggable&&o.setDraggable(!0)})}),jQuery("body").find('input[type="submit"], .gfgeo-locator-button, input.gfgeo-address-field, input.gfgeo-coordinates-field, .gfgeo-advanced-address input').prop("disabled",!1),jQuery("#gform_wrapper_"+e.form_id).removeClass("gfgeo-block-layer"),setTimeout(function(){jQuery(".gfgeo-locator-loader").fadeOut("fast",function(){jQuery(".gfgeo-locator-button").fadeIn()})},500),e["debugger"]("Processing end:"),e["debugger"](e.processing)},300)},GF_Geo.prototype.clear_directions=function(e,o){var d=this;if(!d.init_load_processing&&""!=e.gfgeo_origin_geocoder_id&&-1!=d.inArray(o,e.total_geocoders)){var t=e.gfgeo_id,i=""!=e.gfgeo_route_map_id?e.gfgeo_route_map_id:"",s=".gfgeo-dynamic-field-"+t;if(jQuery("#input_"+e.id+".gfgeo-directions-field-value, #input_"+e.gfgeo_id+".gfgeo-directions-field-value").val(""),(o==e.gfgeo_origin_geocoder_id||o==e.gfgeo_destination_geocoder_id)&&jQuery("#input_"+e.id+"_input, #input_"+e.gfgeo_id+"_input").val(""),jQuery("#input_"+e.id+".gfgeo-directions-field-value, #input_"+e.gfgeo_id+".gfgeo-directions-field-value").val(""),"undefined"!=typeof e.gfgeo_directions_panel_id&&"undefined"!=typeof d.fields[e.gfgeo_directions_panel_id]){var r=d.fields[e.gfgeo_directions_panel_id];jQuery("#input_"+r.id+", #input_"+r.gfgeo_id).val("")}jQuery("#field_"+e.field_key).val(""),jQuery(s).find('input[type="text"], input[type="hidden"], select').val("").trigger("change"),jQuery(s).find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),"undefined"!=typeof d.directionsServices[t]&&(d.directionsServices[t].response="",null!=d.directionsServices[t].DirectionsRenderer.directions&&(d.directionsServices[t].DirectionsRenderer.set("directions",null),jQuery(d.directionsServices[t].DirectionsRenderer.panel).closest("li, tr").slideUp())),""!=i&&"undefined"!=typeof d.maps[i]&&"undefined"!=typeof d.maps[i].polylines.directions[t]&&d.maps[i].polylines.directions[t].setMap(null),d["debugger"]("Clear Directions: geocoder ID "+o+", Directions ID "+e.gfgeo_id)}},GF_Geo.prototype.clear_fields=function(e,o,d){var t=this;if("map"==o){var i=t.fields[e].gfgeo_address_output_disabled;if("undefined"!=typeof i&&1==i)return}"address_geocoder"!=o&&"address_autocomplete"!=o&&"failed_geocoding"!=o&&jQuery('.gfgeo-address-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),("failed_geocoding"==o&&"address_geocoder"!=t.processing.element||"address_autocomplete"==o&&1==t.processing.advanced_address)&&jQuery('.gfgeo-address-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),("advanced_address_geocoder"!=o&&"failed_geocoding"!=o||"failed_geocoding"==o&&"advanced_address_geocoder"!=t.processing.element)&&jQuery(".gfgeo-advanced-address-geocoder-id-"+e).val("").trigger("change"),("coords_geocoder"!=o||"reset_location_button"==o)&&jQuery('.gfgeo-coordinates-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),jQuery("input.gfgeo-geocoded-field-"+e+'[type="text"], input.gfgeo-geocoded-field-'+e+'[type="hidden"]').val("").trigger("change");var s=".gfgeo-dynamic-field-"+e;jQuery(s).find('input[type="text"], input[type="hidden"], select').val("").trigger("change"),jQuery(s).find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),jQuery.isEmptyObject(t.directions_fields)||jQuery.each(t.directions_fields,function(o,d){t.clear_directions(d,e)}),jQuery.isEmptyObject(t.geocoder_directions_fields)||jQuery.each(t.geocoder_directions_fields,function(o,d){t.clear_directions(d,e)}),t["debugger"]("Clear Fields: Geocoder ID"+e+", Element "+o)},GF_Geo.prototype.geocoder_timed_out=function(e){var o=this;o.args.hide_error_messages||o.processing.hide_error_message?console.log(e):alert(e),o.processing_end()},GF_Geo.prototype.geocoder_success=function(e){},GF_Geo.prototype.geocoder_failed=function(e){var o=this,d=o.args.geocoder_failed_error_message[o.processing.element],t=d+". Error: "+e;console.log(t),o.args.hide_error_messages||o.processing.hide_error_message?console.log(d):alert(d),o.clear_fields(o.geocoder_id,"failed_geocoding",!1),o.processing_end()},GF_Geo.prototype.geocoder=function(e,o,d,t){var i=this;if(!i.processing.status){i.processing_start(e,o);var s,r=!1,a=gfgeo_options.country_code;"object"==typeof o?data={latLng:new google.maps.LatLng(o[0],o[1]),region:a}:data={address:o,region:a},geocoder=new google.maps.Geocoder,geocoder.geocode(data,function(a,n){return r?void i.geocoder_timed_out(i.args.geocoder_timeout_message):(clearTimeout(s),n==google.maps.GeocoderStatus.OK?(i["debugger"]("Geocoder Success: Element - "+e+", Results:"),i["debugger"](a),void 0!=d&&0!=d?i[d](a[0]):i.geocoder_success(a[0])):(i["debugger"]("Geocoder Failed: Element "+e+", Results "+n),jQuery(document).trigger("gfgeo_geocoder_failed",[i,e]),"map"!=e||i.args.verify_map_geocoding?"coords_geocoder"!=e||i.args.verify_coords_geocoding?"undefined"!==t&&0!=t?i[t](n):i.geocoder_failed(n):i.coords_geocoder_failed_allowed(o,n):i.map_geocoder_failed_allowed(o,n)))}),s=setTimeout(function(){r=!0},i.args.geocoder_timeout)}},GF_Geo.prototype.map_geocoder_failed_allowed=function(e,o){var d=this;results={formatted_address:"",address_components:""},d.save_location_fields(results,"map")},GF_Geo.prototype.coords_geocoder_failed_allowed=function(e,o){var d=this;alert("No address found."),results={formatted_address:"",address_components:""},d.save_location_fields(results,"coords_geocoder")},GF_Geo.prototype.navigator_success=function(e){self.save_location_fields(e)},GF_Geo.prototype.navigator_failed=function(e){var o=this;o.args.hide_error_messages||o.processing.hide_error_message?console.log(e):alert(e),o.processing_end()},GF_Geo.prototype.navigator=function(e,o,d){function t(t){s.processing.status=!1,s.geocoder(e,[t.coords.latitude,t.coords.longitude],o,d),s["debugger"]("Navigator Success: Element "+e+", Position:"),s["debugger"](t)}function i(t){0!=s.ip_locator&&"fallback"==s.processing.ip_locator?(console.log("fallback ip locator"),s.ip_navigator(e,o,d)):3==t.code?s.geocoder_timed_out(s.args.navigator_error_messages[t.code]):s[d](s.args.navigator_error_messages[t.code]),s["debugger"]("Navigator Failed: Element "+e+", Message:"),s["debugger"](t)}var s=this;if(o="undefined"==o||0==o?"navigator_success":o,d="undefined"==d||0==d?"navigator_failed":d,navigator.geolocation)s.processing_start(e,[]),jQuery(".gfgeo-locator-button.infield-locator").fadeOut("fast",function(){jQuery(".gfgeo-locator-loader").fadeIn()}),navigator.geolocation.getCurrentPosition(t,i,{timeout:s.args.navigator_timeout,enableHighAccuracy:s.args.high_accuracy});else{if(0==s.ip_locator||"fallback"!=s.processing.ip_locator)return s[d](s.args.navigator_error_messages[5]);s.ip_navigator(e,o,d)}},GF_Geo.prototype.ip_navigator_success=function(e){this.save_location_fields(e)},GF_Geo.prototype.ip_navigator_failed=function(e){console.log(e),this.processing_end()},GF_Geo.prototype.ip_navigator=function(e,o,d){function t(t){s.processing.status=!1,s.geocoder(e,t,o,d),s["debugger"]("IP Navigator Sucess: Element "+e+", Results:"),s["debugger"](t)}function i(o){s[d]("Error:\n\n"+JSON.stringify(o,void 0,4)),s["debugger"]("Navigator Failed: Element "+e+", Message:"),s["debugger"](o)}var s=this;o="undefined"==typeof o||0==o?"ip_navigator_success":o,d="undefined"==typeof d||0==d?"ip_navigator_failed":d,s.processing_start(e,[]),jQuery(".gfgeo-locator-button.infield-locator").fadeOut("fast",function(){jQuery(".gfgeo-locator-loader").fadeIn()}),GFGEO_IP_Geocoders[GFGEO_IP_Geocoders.provider].retrievePosition(t,i)},GF_Geo.prototype.page_locator_success=function(e){var o=this;""!=o.processing.found_message&&void 0!=o.processing.found_message&&alert(o.processing.found_message),o.save_location_fields(e,"page_locator")},GF_Geo.prototype.locator_button_success=function(e){var o=this;""!=o.processing.found_message&&void 0!=o.processing.found_message&&alert(o.processing.found_message),o.save_location_fields(e,"locator_button")},GF_Geo.prototype.address_geocoder_success=function(e){this.save_location_fields(e,"address_geocoder")},GF_Geo.prototype.address_field_init=function(e,o){var d=this,t=!1;e.on("input",function(){t=!0}),e.on(d.args.address_field_event_triggers,function(i,s){if(preventFocusout=!1,"undefined"!=typeof s?(s=!0,t=!0):s=!1,t&&("keydown"==i.type&&13==i.which||"focusout"==i.type||"mouseleave"==i.type)){"keydown"==i.type&&13==i.which&&i.preventDefault();var r=jQuery(this);setTimeout(function(){if("focusout"==i.type&&1==preventFocusout)return void(preventFocusout=!1);if(1==d.autocomplete_triggered)d.autocomplete_triggered=!1,preventFocusout=!0,t=!1,d["debugger"]("Address geocoding prevented by autocomplete_triggered");else{if(t=!1,0==s&&"undefined"!=typeof o.gfgeo_force_autocomplete_selection&&1==o.gfgeo_force_autocomplete_selection)return"undefined"!=typeof o.gfgeo_force_autocomplete_selection_message&&""!=o.gfgeo_force_autocomplete_selection_message&&alert(o.gfgeo_force_autocomplete_selection_message),e.val("").focus(),!1;d.geocoder_id=r.data("geocoder_id");var a=e.val();0!=jQuery.trim(a).length?(t=!1,d.geocoder("address_geocoder",a,"address_geocoder_success",!1),d["debugger"]("Address geocoding: Entered address "+a+", event type: "+i.type)):(t=!1,d.clear_fields(d.geocoder_id,"address_geocoder",!1),d["debugger"]("Address geocoding; no address - clearing fields. Event type: "+i.type))}},700)}})},GF_Geo.prototype.advanced_address_field_init=function(e,o){var d=this;e.attr("data-geocoder_id",o.gfgeo_geocoder_id).attr("data-field_id",o.gfgeo_id),e.hasClass("detail-view")&&e.find(".gfgeo-advanced-address-geocoder-id").length>0&&e.addClass("gfgeo-advanced-address-geocoder-id-"+o.gfgeo_geocoder_id);var t=e.find(".ginput_container span"),i=jQuery(t.get(0)),s=t.find("input, select"),r=i.find("input"),a=!1,n={address_line_1:"street",address_line_2:"",state:"region_name",city:"city",zip:"postcode",country:"country_name"};"undefined"!=typeof gform&&(n=gform.applyFilters("gfgeo_modify_gform_address_dynamic_output",n,o.gfgeo_id,o,d)),t.each(function(){var e=jQuery(this),d="",t="";e.hasClass("ginput_address_line_1")?d=n.address_line_1:e.hasClass("ginput_address_line_2")?d=n.address_line_2:e.hasClass("ginput_address_state")?d=n.state:e.hasClass("ginput_address_city")?d=n.city:e.hasClass("ginput_address_zip")?d=n.zip:e.hasClass("ginput_address_country")&&(d=n.country),t=e.find('input[type="text"], select'),""!=d&&t.addClass("gfgeo-advanced-address-geocoder-id-"+o.gfgeo_geocoder_id+" gfgeo-advanced-address-"+d+"-"+o.gfgeo_geocoder_id)}),"undefined"!=typeof o.gfgeo_address_autocomplete&&""!=o.gfgeo_address_autocomplete&&(r.addClass("advanced-address-autocomplete").attr("data-geocoder_id",o.gfgeo_geocoder_id),d.address_autocomplete(r.attr("id"),o,!1)),"undefined"!=typeof o.gfgeo_infield_locator_button&&""!=o.gfgeo_infield_locator_button&&jQuery("#gfgeo-advanced-address-field-locator-button-holder-"+o.gfgeo_id).length>0&&(i.addClass("gfgeo-advanced-address-locator-button-enabled"),jQuery("#gfgeo-advanced-address-field-locator-button-holder-"+o.gfgeo_id).detach().contents().unwrap().prependTo(i)),a=!1,s.on("input",function(){a=!0}),e.on("mouseleave",function(e){setTimeout(function(){if(1==d.autocomplete_triggered&&(d.autocomplete_triggered=!1,a=!1),0==GFGeo_Autocomplete_Visible&&a){var t="";s.each(function(){t=t+" "+jQuery(this).val()}),d.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(t).length?(a=!1,d.geocoder("advanced_address_geocoder",t,"advanced_address_geocoder_success",!1),d["debugger"]("Advanced Address geocoding. Entered address: "+t+". Event type: "+e.type)):(a=!1,d.clear_fields(d.geocoder_id,"advanced_address_geocoder",!1),d["debugger"]("Advanced Address geocoding. No address, clearing fields. Event type: "+e.type))}},700)}),s.on("keydown focusout",function(e){var t=!1;"keydown"==e.type&&13==e.which&&(e.preventDefault(),setTimeout(function(){1==d.autocomplete_triggered?(d.autocomplete_triggered=!1,t=!0,a=!1,d["debugger"]("Address geocoding prevented by autocomplete_triggered")):(a=!1,entered_address="",s.each(function(){entered_address=entered_address+" "+jQuery(this).val()}),d.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(entered_address).length?(d.geocoder("advanced_address_geocoder",entered_address,"advanced_address_geocoder_success",!1),d["debugger"]("Advanced Address geocoding. Entered address: "+entered_address+". Event type: "+e.type)):(d.clear_fields(d.geocoder_id,"advanced_address_geocoder",!1),d["debugger"]("Advanced Address geocoding. No address, clearing fields. Event type: "+e.type)))},700)),"focusout"==e.type&&a&&(focusFields=s,setTimeout(function(){if(!focusFields.is(":focus")){if("focusout"==e.type&&1==t)return void(t=!1);1==d.autocomplete_triggered?(d.autocomplete_triggered=!1,t=!0,a=!1,d["debugger"]("Address geocoding prevented by autocomplete_triggered")):(entered_address="",focusFields.each(function(){entered_address=entered_address+" "+jQuery(this).val()}),d.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(entered_address).length?(a=!1,d.geocoder("advanced_address_geocoder",entered_address,"advanced_address_geocoder_success",!1),d["debugger"]("Advanced Address geocoding. Entered address: "+entered_address+". Event type: "+e.type)):(a=!1,d.clear_fields(d.geocoder_id,"advanced_address_geocoder",!1),d["debugger"]("Advanced Address geocoding. No address - clearing fields. Event type: "+e.type)))}},300))})},GF_Geo.prototype.advanced_address_geocoder_success=function(e){this.save_location_fields(e,"advanced_address_geocoder")},GF_Geo.prototype.coordinates_field_init=function(e){var o=this,d=!1,t=e.find("input");t.on("input",function(){d=!0}),t.on("keydown focusout",function(t){"keydown"==t.type&&13==t.which&&(d=!1,t.preventDefault(),o.coordinates_trigger(e,"enter_key")),"focusout"==t.type&&d&&setTimeout(function(){e.find("input").is(":focus")||(d=!1,o.coordinates_trigger(e,"focusout"))},300)})},GF_Geo.prototype.coordinates_trigger=function(e,o){var d=this;d.geocoder_id=e.data("geocoder_id");var t=e.find(".gfgeo-latitude-field").val().replace(/ /g,""),i=e.find(".gfgeo-longitude-field").val().replace(/ /g,"");""==t||""==i?""==t&&""==i?(d.clear_fields(d.geocoder_id,"coordinates_geocoder",!1),d["debugger"]("Coordinates geocoder. Empty value, clearing fields. Event type: "+o)):"enter_key"==o&&alert("You must enter both latitude and longitude."):(d.geocoder("coords_geocoder",[t,i],"coords_geocoder_success",!1),d["debugger"]("Coordinates geocoding. Entered coords: "+t+", "+i+". Event type: "+o))},GF_Geo.prototype.coords_geocoder_success=function(e){this.save_location_fields(e,"coords_geocoder")},GF_Geo.prototype.default_coords_geocoder_success=function(e){this.save_location_fields(e,"default_coords_geocoder")},GF_Geo.prototype.render_map=function(e){var o=this,d=e.gfgeo_id,t=[],i="undefined"!=typeof e.gfgeo_map_default_latitude&&""!=e.gfgeo_map_default_latitude?e.gfgeo_map_default_latitude:40.7827096,s="undefined"!=typeof e.gfgeo_map_default_longitude&&""!=e.gfgeo_map_default_longitude?e.gfgeo_map_default_longitude:-73.965309,r=""!=e.gfgeo_map_type?e.gfgeo_map_type:"ROADMAP",a=""!=e.gfgeo_zoom_level?e.gfgeo_zoom_level:12,n=""!=e.gfgeo_map_scroll_wheel?e.gfgeo_map_scroll_wheel:!0,g="undefined"!=typeof e.gfgeo_map_styles&&""!=e.gfgeo_map_styles?jQuery.parseJSON(e.gfgeo_map_styles):"",_="undefined"!=typeof e.gfgeo_map_bounds_sw_point&&""!=e.gfgeo_map_bounds_sw_point?e.gfgeo_map_bounds_sw_point.split(","):"",c="undefined"!=typeof e.gfgeo_map_bounds_ne_point&&""!=e.gfgeo_map_bounds_ne_point?e.gfgeo_map_bounds_ne_point.split(","):"";if("undefined"!=typeof e.gfgeo_geocoder_id&&""!=e.gfgeo_geocoder_id&&(t="string"!=typeof e.gfgeo_geocoder_id?e.gfgeo_geocoder_id.map(function(e){return e}):[e.gfgeo_geocoder_id]),o.maps[d]={geocodersId:t,fieldData:e,options:{},latlng:{},map:{},latLngBounds:{},markers:{},infoWindows:{},polylines:{directions:{}},polygons:{},draggedMarker:"",clickedMarker:"",moveOnClickMarker:""},o.maps[d].latlng=new google.maps.LatLng(i,s),o.maps[d].options={zoom:parseInt(a),center:o.maps[d].latlng,mapTypeId:google.maps.MapTypeId[r],backgroundColor:"#f1f1f1",scrollwheel:n,styles:g},""!=_&&""!=c){var l=new google.maps.LatLngBounds(new google.maps.LatLng(_[0],_[1]),new google.maps.LatLng(c[0],c[1]));o.maps[d].options.restriction={latLngBounds:l,strictBounds:!1}}o.maps[d].map=new google.maps.Map(document.getElementById("gfgeo-map-"+d),o.maps[d].options),t.length>0&&o.render_markers(d,t),o.map_single_click=!1,jQuery(document).trigger("gfgeo_render_map",[o,e,o.maps[d].map]),jQuery(document).trigger("gfgeo_map_rendered",[o.maps[d],e,o]),google.maps.event.addListener(o.maps[d].map,"idle",function(){jQuery(document).trigger("gfgeo_map_idle",[o.maps[d],e,o])}),google.maps.event.addListener(o.maps[d].map,"click",function(e){o.map_single_click=!0,setTimeout(function(){if(o.map_single_click&&""!=o.maps[d].moveOnClickMarker){var t=o.maps[d].moveOnClickMarker,i=o.fields[t];1==i.gfgeo_move_marker_via_map_click&&(o.maps[d].draggedMarker=t,o.maps[d].markers[t].setPosition(e.latLng),o.geocoder_id=t,o.processing.element_id=d,o.geocoder("map",[e.latLng.lat(),e.latLng.lng()],"map_geocoder_success",!1))}},200)}),google.maps.event.addListener(o.maps[d].map,"dblclick",function(e){o.map_single_click=!1})},GF_Geo.prototype.render_marker=function(e,o,d){var t,i=this,s=i.fields[o],r="undefined"!=typeof s.gfgeo_map_marker_url&&0!=jQuery.trim(s.gfgeo_map_marker_url).length?s.gfgeo_map_marker_url:"",a="undefined"!=typeof s.gfgeo_address_output_disabled?s.gfgeo_address_output_disabled:!1,n=!0,g=i.maps[d],_=!1,c=g.geocodersId.length;if("undefined"!=typeof s.gfgeo_disable_marker_drag&&(n=0==s.gfgeo_disable_marker_drag?!0:!1),"undefined"!=typeof s.gfgeo_move_marker_via_map_click?t=s.gfgeo_move_marker_via_map_click:(t=!1,s.gfgeo_move_marker_via_map_click=!1),1==t&&""==g.moveOnClickMarker&&(g.moveOnClickMarker=o),0==jQuery.trim(jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+o+" input.latitude").val()).length&&1==c){var l=!1;if("undefined"!=typeof s.gfgeo_map_marker_default_latitude&&"undefined"!=typeof s.gfgeo_map_marker_default_longitude&&0!=jQuery.trim(s.gfgeo_map_marker_default_latitude).length&&0!=jQuery.trim(s.gfgeo_map_marker_default_longitude).length&&(l=!0),(""!=r||0==n||1==t||1==a||"undefined"!=typeof s.gfgeo_marker_info_window&&0!=jQuery.trim(s.gfgeo_marker_info_window).length)&&(l=!0),0==l&&"undefined"!=typeof i.fields[d]){var p=i.fields[d];e=g.map.getCenter(),r=p.gfgeo_map_marker,n=p.gfgeo_draggable_marker,a=p.gfgeo_disable_address_output,t=p.gfgeo_set_marker_on_click}}var f=new google.maps.Marker({position:e,draggable:n,icon:r,gfgeoArgs:{geocoderID:o,mapId:d,defaultPostion:e,draggable:n,markerUrl:r,disableAddressOutput:a}});return"undefined"!=typeof s.gfgeo_marker_info_window&&0!=jQuery.trim(s.gfgeo_marker_info_window).length&&(_=!0,i.maps[d].infoWindows[o]=new google.maps.InfoWindow({content:'<div if="gfgeo-info-window-wrapper-'+o+'" class="gfgeo-info-window-wrapper"><div class="gfgeo-info-window">'+s.gfgeo_marker_info_window+"</div></div>"})),f.addListener("click",function(){var e=jQuery(this)[0].gfgeoArgs.geocoderID;_&&i.maps[d].infoWindows[e].open(i.maps[d].map,jQuery(this)[0]),g.clickedMarker=e,jQuery(document).trigger("gfgeo_marker_clicked",[jQuery(this)[0],i,e,d]),i["debugger"]("Map marker Clicked. Geocoder ID: "+e+". Map ID: "+d)}),google.maps.event.addListener(f,"dragend",function(e){var o=jQuery(this)[0],t=o.gfgeoArgs.geocoderID,s=i.fields[t];"undefined"!=typeof s.gfgeo_move_marker_via_map_click&&1==s.gfgeo_move_marker_via_map_click&&(i.maps[o.gfgeoArgs.mapId].moveOnClickMarker=t),i.maps[o.gfgeoArgs.mapId].draggedMarker=t,i.geocoder_id=t,i.processing.element_id=d,i.geocoder("map",[e.latLng.lat(),e.latLng.lng()],"map_geocoder_success",!1),jQuery(document).trigger("gfgeo_marker_dragged",[jQuery(this)[0],i,t,d]),i["debugger"]("Map marker dragged. Geocoder ID: "+t+". Map ID: "+d)}),f},GF_Geo.prototype.render_markers=function(e,o){var d,t,s,r,a,n=this,g=!1;for(n.maps[e].latLngBounds=new google.maps.LatLngBounds,i=0;i<o.length;i++)"undefined"!=typeof n.fields[o[i]]&&(d=o[i],s=n.fields[d],t={},r=40.7827096,a=-73.965309,existLat=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d+" input.latitude").val(),existLng=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d+" input.longitude").val(),0!=jQuery.trim(existLat).length&&0!=jQuery.trim(existLng).length?(g=!0,r=existLat,a=existLng):"undefined"!=typeof s.gfgeo_map_marker_default_latitude&&"undefined"!=typeof s.gfgeo_map_marker_default_longitude&&0!=jQuery.trim(s.gfgeo_map_marker_default_latitude).length&&0!=jQuery.trim(s.gfgeo_map_marker_default_longitude).length&&(r=s.gfgeo_map_marker_default_latitude,a=s.gfgeo_map_marker_default_longitude),t=new google.maps.LatLng(r,a),n.maps[e].markers[d]=n.render_marker(t,d,e),"undefined"!=typeof s.gfgeo_map_marker_hidden&&1==s.gfgeo_map_marker_hidden&&0==g&&n.maps[e].markers[d].setVisible(!1),t=n.maps[e].markers[d].getPosition(),n.maps[e].latLngBounds.extend(t),n.maps[e].markers[d].setMap(n.maps[e].map));setTimeout(function(){1==o.length?n.maps[e].map.panTo(t):n.maps[e].map.fitBounds(n.maps[e].latLngBounds)},300)},GF_Geo.prototype.update_map=function(e,o,d,t){var i=this;if(jQuery("#gfgeo-map-"+e).length&&(i.maps[e].latLng=new google.maps.LatLng(d,t),"undefined"!=typeof i.maps[e].markers[o])){i.maps[e].markers[o].setVisible(!0),i.maps[e].markers[o].setPosition(i.maps[e].latLng),i.maps[e].map.panTo(i.maps[e].latLng),i.maps[e].latLngBounds=new google.maps.LatLngBounds;var s=0;jQuery.each(i.maps[e].markers,function(o,d){s++,i.maps[e].latLngBounds.extend(d.getPosition())}),s>1&&i.maps[e].map.fitBounds(i.maps[e].latLngBounds),setTimeout(function(){i.maps[e].markers[o].setDraggable(i.maps[e].markers[o].gfgeoArgs.draggable)},800),jQuery(document).trigger("gfgeo_update_map",[i.maps[e],i,d,t])}},GF_Geo.prototype.map_geocoder_success=function(e){this.save_location_fields(e,"map")},GF_Geo.prototype.resize_map_on_show=function(){var e=this;"undefined"!=typeof gform&&gform.addAction("gform_post_conditional_logic_field_action",function(o,d,t,i,s){if(!s&&"show"==d){var r=t.replace("#field_","");0!=jQuery("#gfgeo-map-"+r).length&&"undefined"!=typeof e.maps[r]&&(google.maps.event.trigger(e.maps[r].map,"resize"),1==e.maps[r].geocodersId.length?e.maps[r].map.panTo(e.maps[r].latlng):e.maps[r].map.fitBounds(e.maps[r].latLngBounds))}})},GF_Geo.prototype.address_autocomplete=function(e,o,d){var t=this,i=jQuery("#"+e);"0"==t.args.field_autocomplete&&i.on("focusin",function(){jQuery(this).attr("autocomplete","stop")}),i.on("keydown",function(e){13==e.which&&e.preventDefault()});var s={};if("undefined"!=typeof o.gfgeo_address_autocomplete_types&&""!=o.gfgeo_address_autocomplete_types&&(s.types=[o.gfgeo_address_autocomplete_types]),"undefined"!=typeof o.gfgeo_autocomplete_restriction_usage){"countries"==o.gfgeo_autocomplete_restriction_usage&&"undefined"!=typeof o.gfgeo_address_autocomplete_country&&""!=o.gfgeo_address_autocomplete_country&&(s.componentRestrictions={country:o.gfgeo_address_autocomplete_country});var r,a=!1;if("proximity"==o.gfgeo_autocomplete_restriction_usage){var n="undefined"!=typeof o.gfgeo_autocomplete_proximity_lat&&""!=o.gfgeo_autocomplete_proximity_lat?o.gfgeo_autocomplete_proximity_lat:"",g="undefined"!=typeof o.gfgeo_autocomplete_proximity_lng&&""!=o.gfgeo_autocomplete_proximity_lng?o.gfgeo_autocomplete_proximity_lng:"",_="undefined"!=typeof o.gfgeo_autocomplete_proximity_radius&&""!=o.gfgeo_autocomplete_proximity_radius?o.gfgeo_autocomplete_proximity_radius:"";if(""!=n&&""!=g){a=!0;var c=new google.maps.Circle({center:{lat:parseFloat(n),lng:parseFloat(g)},radius:parseInt(_)});r=c.getBounds()}}else if("area_bounds"==o.gfgeo_autocomplete_restriction_usage){var l="undefined"!=typeof o.gfgeo_autocomplete_bounds_sw_point&&""!=o.gfgeo_autocomplete_bounds_sw_point?o.gfgeo_autocomplete_bounds_sw_point.split(","):"",p="undefined"!=typeof o.gfgeo_autocomplete_bounds_ne_point&&""!=o.gfgeo_autocomplete_bounds_ne_point?o.gfgeo_autocomplete_bounds_ne_point.split(","):"";
""!=l&&""!=p&&(a=!0,r=new google.maps.LatLngBounds(new google.maps.LatLng(l[0],l[1]),new google.maps.LatLng(p[0],p[1])))}1==a&&(s.bounds=r,"undefined"!=typeof o.gfgeo_address_autocomplete_strict_bounds&&""!=o.gfgeo_address_autocomplete_strict_bounds&&(s.strictBounds=!0))}var f=document.getElementById(e);t.autocompletes[e]=new google.maps.places.Autocomplete(f,s),t.autocompletes[e].setFields(t.args.autocomplete_returned_fields),google.maps.event.addListener(t.autocompletes[e],"place_changed",function(d){t.geocoder_id=o.gfgeo_geocoder_id;var i=t.autocompletes[e].getPlace();i.geometry&&""!=t.geocoder_id&&(t.autocomplete_triggered=!0,t.processing_start("address_autocomplete",[i.geometry.location.lat(),i.geometry.location.lng()],i,t,f,o),jQuery(f).hasClass("advanced-address-autocomplete")?t.processing.advanced_address=!0:t.processing.advanced_address=!1,t.processing.selected_address=jQuery(f).val(),"undefined"!=typeof t.autocompletes[e].gm_accessors_.place.Td&&(t.processing.autocomplete_place=t.autocompletes[e].gm_accessors_.place.Td.formattedPrediction),jQuery(f).trigger("change"),t.save_location_fields(i,"address_autocomplete"),t["debugger"]("Address Autocomplete triggered. Field ID: "+e+". Geocoder ID: "+t.geocoder_id))})},GF_Geo.prototype.seconds_to_dhms=function(e){e=Number(e);var o=Math.floor(e/86400),d=Math.floor(e%86400/3600),t=Math.floor(e%3600/60),i=(Math.floor(e%60),o>0?o+(1==o?" day ":" days "):""),s=d>0?d+(1==d?" hour ":" hours "):"",r=t>0?t+(1==t?" minute ":" minutes "):"";return i+s+r},GF_Geo.prototype.haversine_distance_from_coords=function(e,o,d,t){var i=6371,s=e*(Math.PI/180),r=d*(Math.PI/180),a=r-s,n=(t-o)*(Math.PI/180),g=2*i*Math.asin(Math.sqrt(Math.sin(a/2)*Math.sin(a/2)+Math.cos(s)*Math.cos(r)*Math.sin(n/2)*Math.sin(n/2)));return g},GF_Geo.prototype.haversine_distance=function(e,o){var d=6371,t=e.lat()*(Math.PI/180),i=o.lat()*(Math.PI/180),s=i-t,r=(o.lng()-e.lng())*(Math.PI/180),a=2*d*Math.asin(Math.sqrt(Math.sin(s/2)*Math.sin(s/2)+Math.cos(t)*Math.cos(i)*Math.sin(r/2)*Math.sin(r/2)));return a=1e3*a,+a.toFixed(1)},GF_Geo.prototype.meters_convertor=function(e,o,d){return"text"==d?0==o?(e/1e3).toFixed(1)+" km":(.000621371192*e).toFixed(1)+" mi":0==o?(e/1e3).toFixed(1):(.000621371192*e).toFixed(1)},GF_Geo.prototype.get_polyline_options=function(e){var o={strokeColor:"#0088FF",strokeWeight:6,strokeOpacity:.6};if("undefined"!=typeof e&&""!=e){e=e.split(",");for(var d,t=0;t<e.length;t++)-1!=e[t].indexOf(":")&&(d=e[t].split(":"),-1!==jQuery.inArray(d[0],["strokeColor","strokeOpacity","strokeWeight"])&&(o[d[0]]=d[1]))}return o},GF_Geo.prototype.generate_directions_values=function(e,o,d){var t=this;t.generate_location_data(e,"distance_text",o.text),t.generate_location_data(e,"distance_value",o.text.replace(/[^0-9.,]/g,"")),t.generate_location_data(e,"distance_in_meters",o.value),t.generate_location_data(e,"duration_text",d.text),t.generate_location_data(e,"duration_value",d.value)},GF_Geo.prototype.get_directions=function(e,o){var d=this,t=d.directions_fields[e],i={fieldId:e,field:t,fieldUsage:"undefined"!=typeof t.gfgeo_directions_field_usage&&""!=t.gfgeo_directions_field_usage?t.gfgeo_directions_field_usage:"driving_directions",originGeocoderId:""!=t.gfgeo_origin_geocoder_id?t.gfgeo_origin_geocoder_id:"",destinationGeocoderId:""!=t.gfgeo_destination_geocoder_id?t.gfgeo_destination_geocoder_id:"",waypointsGeocoders:""!=t.gfgeo_waypoints_geocoders?t.gfgeo_waypoints_geocoders.map(function(e){return e}):[],unitSystem:t.gfgeo_unit_system,travelMode:t.gfgeo_travel_mode,mapId:""!=t.gfgeo_route_map_id?t.gfgeo_route_map_id:"",directionsPanel:""!=t.gfgeo_directions_panel_id?t.gfgeo_directions_panel_id:"",polylineOptions:""!=t.gfgeo_route_polyline_options?t.gfgeo_route_polyline_options:"",triggeredDynamically:o};"undefined"!=typeof gform&&(i=gform.applyFilters("gfgeo_get_directions_args",i,d)),"straight_line"==i.fieldUsage?d.get_straight_line_distance(i):d.get_driving_directions(i)},GF_Geo.prototype.get_straight_line_distance=function(e){var o=this;setTimeout(function(){var d=e.field,t=e.originGeocoderId,s=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t):"",r=e.destinationGeocoderId,a=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+r).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+r):"";if(o.processing_start("straight_line_distance",[]),""!=s&&"1"==s.find(".status").val()&&""!=a&&"1"==a.find(".status").val()){var n,g,_=s.find("input.latitude").val(),c=s.find("input.longitude").val(),l=s.find("input.address").val(),p=new google.maps.LatLng(_,c),f=a.find("input.latitude").val(),u=a.find("input.longitude").val(),m=a.find("input.address").val(),y=new google.maps.LatLng(f,u),v=e.fieldId,h="metric"==e.unitSystem?google.maps.UnitSystem.METRIC:google.maps.UnitSystem.IMPERIAL,b=e.mapId,j={},Q=0,w=0,k=""!=b&&jQuery("#gfgeo-map-"+b).length?!0:!1,G={text:"",value:0},L={text:"",value:0},F=t,I=p,x=l,M={origin:p,destination:y,waypoints:[],legs:[],complete:{distance:{value:"",text:""},duration:{value:"",text:""}}};if(j[t]=p,0!==e.waypointsGeocoders.length)for(i=0;i<e.waypointsGeocoders.length;i++){var E=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]):"";""!=E&&"1"==E.find(".status").val()&&(wplat=E.find("input.latitude").val(),wplng=E.find("input.longitude").val(),g=E.find("input.address").val(),n=new google.maps.LatLng(wplat,wplng),j[e.waypointsGeocoders[i]]=n,Q=o.haversine_distance(I,n),G.value+=Q,M.legs.push({geocoders:[F,e.waypointsGeocoders[i]],addresses:[x,g],distance:{text:o.meters_convertor(Q,h,"text"),value:Q}}),I=n,F=e.waypointsGeocoders[i],w++)}j[r]=y,Q=o.haversine_distance(I,y),M.legs.push({geocoders:[F,r],addresses:[x,m],distance:{text:o.meters_convertor(Q,h,"text"),value:Q}}),G.value+=Q,G.text=o.meters_convertor(G.value,h,"text"),M.complete.distance.value=G.value,M.complete.distance.text=G.text;var D=JSON.stringify(M);if(jQuery("#input_"+d.gfgeo_id+".gfgeo-directions-field-value, #input_"+d.id+".gfgeo-directions-field-value").val(D),jQuery("#input_"+d.gfgeo_id+"_triggered, #input_"+d.id+"_triggered").val("1"),"undefined"!=typeof d.gfgeo_directions_panel_id&&"undefined"!=typeof o.fields[d.gfgeo_directions_panel_id]){var S=o.fields[d.gfgeo_directions_panel_id];jQuery("#input_"+S.gfgeo_id+", #input_"+S.id).val(D)}if(k){var A,O,C=Object.keys(j);for("undefined"!=typeof o.maps[b].polylines.directions[v]&&o.maps[b].polylines.directions[v].setMap(null),polylineOptions=o.get_polyline_options(e.polylineOptions),polylineOptions.path=Object.values(j),polylineOptions.map=o.maps[b].map,o.maps[b].polylines.directions[v]=new google.maps.Polyline(polylineOptions),o.maps[b].latLngBounds=new google.maps.LatLngBounds,i=0;i<C.length;i++)O=C[i],A=j[O],o.maps[b].latLngBounds.extend(A),"undefined"==typeof o.maps[b].markers[O]?(o.maps[b].markers[O]=o.render_marker(A,O,b),o.maps[b].markers[O].setMap(o.maps[b].map)):o.maps[b].markers[O].setPosition(A);o.maps[b].map.fitBounds(o.maps[b].latLngBounds)}o.generate_directions_values(v,G,L),jQuery(document).trigger("gfgeo_straight_line_distance_success",[v,G,L,M,e,o]),o.processing_end()}else if(1==e.triggeredDynamically)o.processing_end();else if(0==e.triggeredDynamically){var P="",T=!1;(""==s||"1"!=s.find("input.status").val())&&(T=!0,P=o.args.directions_missing_origin_message),(""==a||"1"!=a.find("input.status").val())&&(P=1==T?o.args.directions_missing_both_message:o.args.directions_missing_destination_message),alert(P),o.processing_end()}},500)},GF_Geo.prototype.get_driving_directions=function(e){var o=this;o.processing_start("driving_directions",[]);var d=e.field,t=e.originGeocoderId,s=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t):"",r=e.destinationGeocoderId,a=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+r).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+r):"";if(""!=s&&"1"==s.find(".status").val()&&""!=a&&"1"==a.find(".status").val()){var n=e.fieldId,g=e.mapId,_=e.directionsPanel,c=""!=g&&jQuery("#gfgeo-map-"+g).length?!0:!1,l=""!=_?!0:!1,p=!1;if("undefined"==typeof o.directionsServices[n]&&(o.directionsServices[n]={response:"",directionsService:new google.maps.DirectionsService,DirectionsRenderer:!1,element:null}),null==o.directionsServices[n].element||o.directionsServices[n].element.is(jQuery("#gfgeo-directions-field-wrapper-"+n))||(p=!0),(0==o.directionsServices[n].DirectionsRenderer||1==p)&&(o.directionsServices[n].element=jQuery("#gfgeo-directions-field-wrapper-"+n),1==c||1==l)){var f={suppressMarkers:!0};1==c&&(f.map=o.maps[g].map,f.polylineOptions=o.get_polyline_options(e.polylineOptions),o.directionsServices[n].mapElement=jQuery("#gfgeo-map-"+g)),1==l&&(f.panel=document.getElementById("gfgeo-directions-panel-holder-"+_)),o.directionsServices[n].DirectionsRenderer=new google.maps.DirectionsRenderer(f),o.directionsServices[n].DirectionsRenderer.addListener("directions_changed",function(){var e=jQuery(this)[0].getPanel();"undefined"!==e&&jQuery(e).closest("li, tr").slideDown()})}if(!o.isEmpty(o.directionsServices[n].response)&&0!=o.directionsServices[n].DirectionsRenderer&&!o.args.disable_directions_cache)return console.log("Using cached directions"),o.directionsServices[n].DirectionsRenderer.setDirections(o.directionsServices[n].response),void o.processing_end();setTimeout(function(){var _,l,p=s.find("input.latitude").val(),f=s.find("input.longitude").val(),u=s.find("input.address").val(),m=new google.maps.LatLng(p,f),y=a.find("input.latitude").val(),v=a.find("input.longitude").val(),h=a.find("input.address").val(),b=new google.maps.LatLng(y,v),j=[],Q=[],w=!1,k="metric"==e.unitSystem?google.maps.UnitSystem.METRIC:google.maps.UnitSystem.IMPERIAL;if(0!==e.waypointsGeocoders.length)for(i=0;i<e.waypointsGeocoders.length;i++){var G=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]):"";""!=G&&"1"==G.find(".status").val()&&(_=G.find(".latitude").val(),l=G.find(".longitude").val(),j.push({location:new google.maps.LatLng(_,l),stopover:!0}),Q.push(e.waypointsGeocoders[i]),w=!0)}var L={origin:m,destination:b,travelMode:e.travelMode,unitSystem:k,waypoints:j,optimizeWaypoints:w};"undefined"!=typeof gform&&(L=gform.applyFilters("gfgeo_driving_directions_options",L,t,r,o,e)),o.directionsServices[n].directionsService.route(L,function(s,a){if("OK"==a){console.log("Calculating new directions"),o.directionsServices[n].response=s;var _={text:"",value:0},l={text:"",value:0},p=[t],f=s.routes[0].legs.slice(),y={origin:m,destination:b,waypoints:[],legs:[],complete:{distance:{value:"",text:""},duration:{value:"",text:""}}};if(0!=o.directionsServices[n].DirectionsRenderer&&o.directionsServices[n].DirectionsRenderer.setDirections(s),"undefined"!=typeof Q&&s.routes[0].legs.length>1){var v=s.routes[0].waypoint_order;for(i=0;i<v.length;i++)p.push(Q[v[i]])}for(p.push(r),i=0;i<p.length;i++)geocoderId=p[i],i<p.length-1?(markerPosition=f[i].start_location,_.value+=f[i].distance.value,l.value+=f[i].duration.value,y.waypoints.push(f[i].end_location),y.legs.push({geocoders:[geocoderId,p[i+1]],addresses:[f[i].start_address,f[i].end_address],distance:f[i].distance,duration:f[i].duration})):i==p.length-1&&(markerPosition=f[i-1].end_location),1==c&&("undefined"==typeof o.maps[g].markers[geocoderId]?(o.maps[g].markers[geocoderId]=o.render_marker(markerPosition,geocoderId,g),o.maps[g].markers[geocoderId].setMap(o.maps[g].map)):o.maps[g].markers[geocoderId].setPosition(markerPosition));l.text=o.seconds_to_dhms(l.value),_.text=0==k?(_.value/1e3).toFixed(1)+" km":(.000621371192*_.value).toFixed(1)+" mi",y.complete.distance.value=_.value,y.complete.distance.text=_.text,y.complete.duration.value=l.value,y.complete.duration.text=l.text;var j=JSON.stringify(y);if(jQuery("#input_"+d.gfgeo_id+".gfgeo-directions-field-value, #input_"+d.id+".gfgeo-directions-field-value").val(j),jQuery("#input_"+d.gfgeo_id+"_triggered, #input_"+d.id+"_triggered").val("1"),"undefined"!=typeof d.gfgeo_directions_panel_id&&"undefined"!=typeof o.fields[d.gfgeo_directions_panel_id]){var w=o.fields[d.gfgeo_directions_panel_id];jQuery("#input_"+w.gfgeo_id+", #input_"+w.id).val(j)}o.generate_directions_values(n,_,l),o.generate_directions_values(t,_,l),jQuery(document).trigger("gfgeo_driving_directions_success",[n,_,l,y,e,s,o]),o.processing_end()}else{if(console.log(a),"ZERO_RESULTS"==a){var G=o.args.directions_failed_message;alert(G.replace("%origin%",u).replace("%destination%",h))}jQuery(document).trigger("gfgeo_driving_directions_failed",[n,e,s,o]),o.processing_end()}})},1e3)}else if(1==e.triggeredDynamically)o.processing_end();else if(0==e.triggeredDynamically){var u="",m=!1;(""==s||"1"!=s.find("input.status").val())&&(m=!0,u=o.args.directions_missing_origin_message),(""==a||"1"!=a.find("input.status").val())&&(u=1==m?o.args.directions_missing_both_message:o.args.directions_missing_destination_message),alert(u),o.processing_end()}},GF_Geo.prototype.generate_location_data=function(e,o,d){jQuery("input.gfgeo-geocoded-field-"+e+"."+o+'[type="hidden"]').val(d).trigger("change");var t=".gfgeo-dynamic-"+o+"-"+e;jQuery(t).find('input[type="text"], input[type="hidden"], input[type="number"], select').val(d).trigger("change"),jQuery(t).find('input[type="checkbox"][value="'+d+'"], input[type="radio"][value="'+d+'"]').prop("checked",!0).trigger("change");var i=".gfgeo-advanced-address-"+o+"-"+e;jQuery('input[type="text"]'+i+',input[type="hidden"]'+i+",select"+i).each(function(){jQuery(this).val().length||(console.log(d),jQuery(this).val(d).trigger("change"))})},GF_Geo.prototype.get_place_details=function(e,o,d){var t=this;if(void 0!==o.name)t.generate_location_data(t.geocoder_id,"place_name",o.name);else{var i=new google.maps.places.PlacesService(jQuery("<div>").get(0)),s={placeId:e.place_id,fields:t.args.get_details_returned_fields};i.getDetails(s,function(i,s){"OK"==s&&(void 0!==i.name&&t.generate_location_data(t.geocoder_id,"place_name",i.name),jQuery(document).trigger("gfgeo_place_details",[i,o,e,d,t]))})}},GF_Geo.prototype.save_location_fields=function(e,o){var d=this;if(console.log(e),0!=d.processing.locator_id&&""!=d.processing.locator_id&&jQuery("#gfgeo-infield-locator-button-"+d.processing.locator_id).closest(".gfield").find(".gfgeo-address-field").val(e.formatted_address).trigger("change"),""==d.geocoder_id)return void d.processing_end();if(jQuery(document).trigger("gfgeo_save_location_data_start",[e,o,d]),d.clear_fields(d.geocoder_id,o,!0),address_fields={street_number:"",street_name:"",street:"",street_nsp:"",street_bw:"",street_bw_nsp:"",premise:"",subpremise:"",neighborhood:"",city:"",region_code:"",region_name:"",country:"",postcode:"",country_code:"",country_name:"",address:e.formatted_address,formatted_address:e.formatted_address,lat:"",lng:"",place_id:e.place_id||"",distance:"",duration:""},"coords_geocoder"==o||"map"==o?(address_fields.lat=d.processing.location[0],address_fields.lng=d.processing.location[1]):(address_fields.lat=e.geometry.location.lat(),address_fields.lng=e.geometry.location.lng()),("address_geocoder"==o||"advanced_address_geocoder"==o)&&"string"==typeof d.processing.location&&(address_fields.address=d.processing.location.trim()),"address_autocomplete"==o&&(address_fields.address=d.processing.selected_address),jQuery.each(d.maps,function(e,t){("map"!=o||"map"==o&&e!=d.processing.element_id)&&-1!==jQuery.inArray(d.geocoder_id,t.geocodersId)&&d.update_map(e,d.geocoder_id,address_fields.lat,address_fields.lng)}),"page_locator"==o&&0!=jQuery('input[data-geocoder_id="'+d.geocoder_id+'"][data-address_autocomplete="1"][data-autocomplete_locator_bounds="1"]').length&&address_fields.lat){var t=jQuery('input[data-geocoder_id="'+d.geocoder_id+'"][data-address_autocomplete="1"][data-autocomplete_locator_bounds="1"]').attr("id"),i=new google.maps.Circle({center:{lat:address_fields.lat,lng:address_fields.lng}});d.autocompletes[t].setBounds(i.getBounds())}if(d.generate_location_data(d.geocoder_id,"latitude",address_fields.lat),d.generate_location_data(d.geocoder_id,"longitude",address_fields.lng),jQuery('.gfgeo-latitude-field[data-geocoder_id="'+d.geocoder_id+'"]').val(address_fields.lat).trigger("change"),jQuery('.gfgeo-longitude-field[data-geocoder_id="'+d.geocoder_id+'"]').val(address_fields.lng).trigger("change"),"map"==o){var s=d.maps[d.processing.element_id],r=s.markers[s.draggedMarker].gfgeoArgs.disableAddressOutput;if(1==r)return jQuery("input.gfgeo-geocoded-field-"+d.geocoder_id+".status").val("1").trigger("change"),d.processing_end(),address_fields}"address_geocoder"!=o&&("address_autocomplete"!=o||"address_autocomplete"==o&&1==d.processing.advanced_address)&&jQuery('.gfgeo-address-field[data-geocoder_id="'+d.geocoder_id+'"]').val(e.formatted_address).trigger("change"),d.generate_location_data(d.geocoder_id,"address",address_fields.address),d.generate_location_data(d.geocoder_id,"formatted_address",address_fields.formatted_address),address_fields.place_id&&(jQuery(".gfgeo-place_name").length||1==d.args.place_details_enabled)&&d.get_place_details(address_fields,e,o),address=e.address_components||[];var a=!1,n=!1;for(var g in address){if("street_number"==address[g].types&&void 0!=address[g].long_name&&(address_fields.street_number=address[g].long_name,d.generate_location_data(d.geocoder_id,"street_number",address_fields.street_number)),"subpremise"==address[g].types&&void 0!=address[g].long_name&&(address_fields.subpremise=address[g].long_name,d.generate_location_data(d.geocoder_id,"subpremise",address_fields.subpremise)),"route"==address[g].types&&void 0!=address[g].long_name){if(address_fields.street_name=address[g].long_name,d.generate_location_data(d.geocoder_id,"street_name",address_fields.street_name),""!=address_fields.street_number){var _=" ";""!=address_fields.subpremise&&(_="/"+address_fields.subpremise+" "),address_fields.street=address_fields.street_number+_+address_fields.street_name,address_fields.street_nsp=address_fields.street_number+" "+address_fields.street_name,address_fields.street_bw=address_fields.street_name+_+address_fields.street_number,address_fields.street_bw_nsp=address_fields.street_name+" "+address_fields.street_number}else address_fields.street=address_fields.street_name,address_fields.street_nsp=address_fields.street_name,address_fields.street_bw=address_fields.street_name,address_fields.street_bw_nsp=address_fields.street_name;d.generate_location_data(d.geocoder_id,"street",address_fields.street),d.generate_location_data(d.geocoder_id,"street_nsp",address_fields.street_nsp),d.generate_location_data(d.geocoder_id,"street_bw",address_fields.street_bw),d.generate_location_data(d.geocoder_id,"street_bw_nsp",address_fields.street_bw_nsp)}"premise"==address[g].types&&void 0!=address[g].long_name&&(address_fields.premise=address[g].long_name,d.generate_location_data(d.geocoder_id,"premise",address_fields.premise)),"neighborhood,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.neighborhood=address[g].long_name,d.generate_location_data(d.geocoder_id,"neighborhood",address_fields.neighborhood)),"locality,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.city=address[g].long_name,d.generate_location_data(d.geocoder_id,"city",address_fields.city),a=!0),"administrative_area_level_3,political"==address[g].types&&void 0!=address[g].long_name&&(n=address[g].long_name),a||"political,sublocality,sublocality_level_1"!=address[g].types&&"sublocality_level_1,sublocality,political"!=address[g].types||void 0==address[g].long_name||(address_fields.city=address[g].long_name,d.generate_location_data(d.geocoder_id,"city",address_fields.city),a=!0),a||"postal_town"!=address[g].types||void 0==address[g].long_name||(address_fields.city=address[g].long_name,d.generate_location_data(d.geocoder_id,"city",address_fields.city),a=!0),"administrative_area_level_2,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.county=address[g].long_name,d.generate_location_data(d.geocoder_id,"county",address_fields.county)),"administrative_area_level_1,political"==address[g].types&&(address_fields.region_name=address[g].long_name,address_fields.region_code=address[g].short_name,d.generate_location_data(d.geocoder_id,"region_code",address_fields.region_code),d.generate_location_data(d.geocoder_id,"region_name",address_fields.region_name)),"postal_code"==address[g].types&&void 0!=address[g].long_name&&(address_fields.postcode=address[g].long_name,d.generate_location_data(d.geocoder_id,"postcode",address_fields.postcode)),"country,political"==address[g].types&&(address_fields.country_name=address[g].long_name,address_fields.country_code=address[g].short_name,d.generate_location_data(d.geocoder_id,"country_code",address_fields.country_code),d.generate_location_data(d.geocoder_id,"country_name",address_fields.country_name)),jQuery(document).trigger("gfgeo_save_location_field_data",[address[g],d,e,o])}return a||0==n||d.generate_location_data(d.geocoder_id,"city",n),jQuery("input.gfgeo-geocoded-field-"+d.geocoder_id+".status").val("1").trigger("change"),d.init_load_processing||jQuery.isEmptyObject(d.directions_fields)&&jQuery.isEmptyObject(d.geocoder_directions_fields)?d.processing_end():(jQuery.isEmptyObject(d.directions_fields)||jQuery.each(d.directions_fields,function(e,o){"button"==o.gfgeo_trigger_directions_method?!(d.inArray(d.geocoder_id,o.gfgeo_waypoints_geocoders)>-1)||d.isEmpty(jQuery("#input_"+o.gfgeo_id+"_triggered").val())&&d.isEmpty(jQuery("#input_"+o.id+"_triggered").val())?d.processing_end():d.get_directions(e,!1):d.inArray(d.geocoder_id,o.total_geocoders)>-1?d.get_directions(e,!0):d.processing_end()}),jQuery.isEmptyObject(d.geocoder_directions_fields)||jQuery.each(d.geocoder_directions_fields,function(e,o){if(d.inArray(d.geocoder_id,o.total_geocoders)>-1){var t={fieldId:e,field:o,fieldUsage:"driving_directions",originGeocoderId:e,destinationGeocoderId:o.gfgeo_distance_destination_geocoder_id,waypointsGeocoders:[],unitSystem:o.gfgeo_distance_unit_system,travelMode:o.gfgeo_distance_travel_mode,mapId:o.gfgeo_route_map_id,directionsPanel:""!=o.gfgeo_distance_directions_panel_id?o.gfgeo_distance_directions_panel_id:"",polylineOptions:"",triggeredDynamically:!0};d.get_driving_directions(t)}else d.processing_end()})),jQuery(document).trigger("gfgeo_save_location_data_end",[address_fields,d,e,o]),address_fields};