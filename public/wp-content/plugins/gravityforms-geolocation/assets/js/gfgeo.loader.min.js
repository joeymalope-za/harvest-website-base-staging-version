var GFGEO_IP_Geocoders={provider:gfgeo_options.ip_locator||"ipinfo",ipinfo:{token:gfgeo_options.ip_token||"",retrievePosition:function(e,o){var i=""!=this.token?"/?token="+this.token:"";jQuery.getJSON(gfgeo_options.protocol+"://ipinfo.io"+i,function(i){console.log(i);var t=i.loc.split(",");"undefined"!=typeof t[0]?e(t):o("we were unable to detect your location")}).fail(function(e,i,t){"timeout"==i&&o("The server is not responding"),"error"==i&&o(e.responseJSON.error.title)})}},maxmind:{retrievePosition:function(e,o){e=e,"undefined"!=typeof geoip2&&geoip2.insights(function(o){console.log(o),e([o.location.latitude,o.location.longitude])},function(e){o(e)})}},ipapico:{retrievePosition:function(e,o){jQuery.get("https://ipapi.co/latlong/",function(i){console.log(i);var t=i.split(",");"undefined"!=typeof t[0]?e(t):o("we were unable to detect your location")}).fail(function(e,i,t){o("timeout"==i?"The server is not responding":"error"==i?t:"we were unable to detect your location")})}},ipregistry:{token:gfgeo_options.ip_token||"",retrievePosition:function(e,o){var i=""!=this.token?"/?key="+this.token:"";jQuery.getJSON("https://api.ipregistry.co/"+i,function(o){console.log(o),e([o.location.latitude,o.location.longitude])}).fail(function(e,i,t){"timeout"==i&&o("The server is not responding"),"error"==i&&o(e.responseJSON.message)})}}};GF_Geo.prototype.init=function(){var e=this;jQuery("form#gform_"+e.form_id).attr("data-form_id",e.form_id),"undefined"!=typeof gform&&(e=gform.applyFilters("gfgeo_form_object",e)),"maxmind"==e.ip_locator&&"undefined"==typeof geoip2&&(e.ip_locator=!1);var o,i,t={geocoders:[],addresses:[],pageLocator:!1,directions:[]};if("undefined"!=typeof gfgeo_options.form_prefix&&""!=gfgeo_options.form_prefix&&("va"==gfgeo_options.form_prefix||"ex"==gfgeo_options.form_prefix)){jQuery("#entry_form").find(".ginput_container.ginput_container_gfgeo_directions_panel, .ginput_container.ginput_container_gfgeo_directions.trigger-dynamically, .ginput_container.ginput_container_gfgeo_geocoder").closest("tr").hide(),jQuery.each(e.fields,function(r,n){if(o=n.gfgeo_id,i="undefined"!=typeof n.gfgeo_geocoder_id?n.gfgeo_geocoder_id:"","gfgeo_geocoder"==n.type){var g=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+o);1!=g.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update)&&(jQuery("#gfgeo-geocoder-default-coordinates-"+o).length?1!=g.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update&&1==e.args.geocode_default_location)&&(e.geocoder_id=o,t.geocoders.push(e.geocoder_id)):1==e.args.is_page_load&&1==n.gfgeo_page_locator&&(t.pageLocator=n))}if("gfgeo_map"==n.type&&jQuery("#gfgeo-map-"+o).length&&1!=n.adminOnly&&(e.map_field_exists=!0,"undefined"!=typeof n.gfgeo_delay_map_render?setTimeout(function(){e.render_map(n)},n.gfgeo_delay_map_render):e.render_map(n)),"gfgeo_address"==n.type){var d=jQuery('input.gfgeo-address-field[data-field_id="'+o+'"]');""!=i&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+i).length&&(e.address_field_init(d,n),1==e.args.is_page_load&&0!=jQuery.trim(d.val()).length&&1!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+i).find(".status").val()&&t.addresses.push(d)),1==n.gfgeo_address_autocomplete&&"undefined"!=typeof d.attr("id")&&e.address_autocomplete(d.attr("id"),n,!1)}"gfgeo_coordinates"==n.type&&""!=i&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+i).length&&e.coordinates_field_init(jQuery("#gfgeo-coordinates-wrapper-"+o)),"address"!=n.type||"undefined"!=typeof n.gfgeo_disable_field_geocoding&&1==n.gfgeo_disable_field_geocoding||""!=i&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+i).length&&e.advanced_address_field_init(jQuery("#field_"+o),n),("text"==n.type||"post_custom_field"==n.type)&&1==n.gfgeo_address_autocomplete&&e.address_autocomplete("input_"+o,n,!1),e.args.is_edit_entry&&"undefined"!=typeof n.gfgeo_dynamic_field_usage&&jQuery(".detail-view#field_"+o).addClass(n.cssClass),("gfgeo_locator_button"===n.type||"gfgeo_address"===n.type||"address"===n.type)&&jQuery(document).on("click","#gfgeo-locator-button-"+o+", #gfgeo-infield-locator-button-"+o,function(){e.processing.status||"undefined"==typeof n.gfgeo_geocoder_id||""==n.gfgeo_geocoder_id.length||(e.geocoder_id=n.gfgeo_geocoder_id,e.processing.locator_id=n.gfgeo_id,e.processing.found_message="undefined"!=typeof n.gfgeo_location_found_message?n.gfgeo_location_found_message:"",e.processing.hide_error_message="undefined"!=typeof n.gfgeo_hide_location_failed_message?n.gfgeo_hide_location_failed_message:!1,0!=e.ip_locator&&(e.processing.ip_locator="undefined"!=typeof n.gfgeo_ip_locator_status?n.gfgeo_ip_locator_status:""),0!=e.ip_locator&&"default"==e.processing.ip_locator?(console.log("IP Address Locator"),e.ip_navigator("ip_locator_button","locator_button_success",!1)):(console.log("HTML5 Locator"),e.navigator("locator_button","locator_button_success",!1)))}),"gfgeo_reset_location_button"===n.type&&jQuery(document).on("click","#gfgeo-reset-location-button-"+o,function(){if(!e.processing.status&&"undefined"!=typeof n.gfgeo_geocoder_id&&n.gfgeo_geocoder_id.length>0){var o=n.gfgeo_geocoder_id;1==o.length?e.clear_fields(o[0],"reset_location_button",!1):jQuery.each(o,function(o,i){setTimeout(function(){e.geocoder_id=i,e.clear_fields(i,"reset_location_button",!1)},300)})}}),"gfgeo_directions"===n.type&&(jQuery("#gfgeo-get-directions-button-"+o).on("click",function(){e.isEmpty(jQuery("#input_"+n.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+n.id).val())&&e.get_directions(jQuery(this).data("field_id"),!1)}),jQuery("#gfgeo-clear-directions-button-"+o).on("click",function(){var o=jQuery(this).data("field_id"),i=e.directions_fields[o];return""==i.gfgeo_origin_geocoder_id?!1:(geocoderId=i.gfgeo_origin_geocoder_id,void e.clear_directions(i,geocoderId))}),e.isEmpty(jQuery("#input_"+n.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+n.id).val())?"button"!=n.gfgeo_trigger_directions_method&&t.directions.push([o,!1]):t.directions.push([o,!0]))});var r=500,n=this.args.init_geocoding_delay,g=t.geocoders.length,d=t.addresses.length,s=t.directions.length;(g>0||d>0||0!=t.pageLocator||s>0)&&(g+d+s>1&&(e.init_load_processing=!0),jQuery.each(t,function(o,i){if("geocoders"==o&&g>0)jQuery.each(i,function(o,i){setTimeout(function(){e.geocoder_id=i,e["debugger"]("Geocoding default geocoder "+i);var o=jQuery("#gfgeo-geocoder-default-coordinates-"+e.geocoder_id).data();e.geocoder("default_coords_geocoder",[o.latitude,o.longitude],"default_coords_geocoder_success",!1)},r),r+=n});else if("addresses"==o&&d>0)jQuery.each(i,function(o,i){setTimeout(function(){e["debugger"]("Geocoding default address "+i.data("field_id")),i.trigger("focusout",[!0])},r),r+=n});else if("pageLocator"==o&&0!=i){var _=i;setTimeout(function(){e["debugger"]("Running page locator."),e.page_locator.triggered=!0,e.processing.found_message=_.gfgeo_location_found_message,e.processing.hide_error_message="undefined"!=typeof _.gfgeo_hide_location_failed_message?_.gfgeo_hide_location_failed_message:!1,e.geocoder_id=_.gfgeo_id,0!=e.ip_locator&&(e.processing.ip_locator=void 0!==_.gfgeo_ip_locator_status?_.gfgeo_ip_locator_status:""),pageLocatorExists=!0,0!=e.ip_locator&&"default"==e.processing.ip_locator?e.ip_navigator("ip_page_locator","page_locator_success",!1):e.navigator("page_locator","page_locator_success",!1)},r)}else if("directions"==o&&s>0){var a=g+d;jQuery.each(i,function(o,i){(1==i[1]||a>1||a>0&&0!=t.pageLocator)&&(setTimeout(function(){e["debugger"]("Default Directions "+i[0]),e.get_directions(i[0],!0)},r),r+=n)})}setTimeout(function(){e.init_load_processing=!1},200+g*n+d*n)})),jQuery(".tingle-modal.gpnf-modal").length&&setTimeout(function(){jQuery(".pac-container").detach().insertBefore("body")},800),e.map_field_exists&&e.resize_map_on_show()}};var GFGeo_Autocomplete_Visible=!1;jQuery(document).on("mouseenter mouseleave",".pac-container:visible",function(e){GFGeo_Autocomplete_Visible="mouseenter"===e.type?!0:!1}),"false"==gfgeo_options.is_admin?jQuery(document).bind("gform_post_render",function(e,o,i){return"undefined"!=typeof i&&"undefined"!=typeof gfgeo_gforms[o]&&jQuery("#gform_wrapper_"+o).length?("undefined"==typeof GFGeo_Forms[o]&&(GFGeo_Forms[o]=new GF_Geo(gfgeo_gforms[o],i)),void GFGeo_Forms[o].init()):!1}):jQuery(document).ready(function(e){if(0==gfgeo_options.edit_entry_form_id||"undefined"==typeof gfgeo_gforms[gfgeo_options.edit_entry_form_id]||!jQuery("#entry_form").length)return console.log("something went wrong while trying to retrive the form object."),!1;if("false"==gfgeo_options.disable_script_init){var o=gfgeo_options.edit_entry_form_id;"undefined"==typeof GFGeo_Forms[o]&&(GFGeo_Forms[o]=new GF_Geo(gfgeo_gforms[o],1)),GFGeo_Forms[o].init()}});